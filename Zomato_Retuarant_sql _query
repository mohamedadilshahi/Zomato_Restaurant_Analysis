
-- Create Database

create Database Zomato

-- Select the Database 

use zomato

-- Import the csv file from the import wizard option
-- make sure to use the correct datatype as per datamodel


-- Explore import data

-- Restaurant Data
select * from Restaurant_Data

--Country Data
select * from Country_Data


-- 1. Get overall statastics for the Indian restaurant market.

select COUNT(*) as 'Total_Restaurants', 
       COUNT(distinct City) as 'Total_cities',
	   avg(rating) as 'avg_rating',
	   AVG(Average_Cost_for_two) as 'avg_cost'
from Restaurant_Data r
inner join Country_Data c
on r.CountryCode=c.Country_Code
where Country = 'India'


-- 2. Top 10 Indian cities with number of restaurant, average rating, average cost

select top 10 City, COUNT(distinct RestaurantName) as 'Total_restaurants', 
             AVG(rating) as 'Avg_rating',
			 AVG(average_cost_for_two) as 'avg_cost',
			 country
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country = 'India'
group by City, Country
order by Total_restaurants desc


-- 3. Understand pricing segments and their relationship with ratings in India.

select Price_range, count(*) as 'total_restaurants',
       AVG(rating) as 'avg_rating',
	   MIN(average_cost_for_two) as 'min_cost',
	   MAX(average_cost_for_two) as 'max_cost',
	   COUNT(*) * 100 / (select COUNT(*) from Restaurant_Data where CountryCode = 1) as 'percentage'
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country = 'India'
group by Price_range
order by total_restaurants  desc


-- Note: aur calculation is with price_range how many restaurants are their in India.


-- 4. Compare restaurants types based on service offerings in India. 
--    Online delivery vs dine-in analysis.

select Has_Table_booking, Has_Online_delivery,
       count(restaurantname) as 'Total_restaurants',
	   AVG(rating) as 'avg_ratng',
       AVG( Average_Cost_for_two) as 'avg_cost',
	   AVG(votes) as 'avg_votes'
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country = 'India'
group by Has_Table_booking, Has_Online_delivery
order by Total_restaurants desc



-- 5. Identify top 15 most popular cuisine types and their performance metrics in India. 

select top 15 Cuisines, COUNT(Cuisines) as total,
                        avg(Rating) avg_rating,
						avg(Average_Cost_for_two) avg_cost,
						avg(Votes) avg_votes

from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country='India'
group by Cuisines
order by total desc, avg_rating desc
-- Note: higher the average rating is the best performance

select * from Restaurant_Data


-- 6. Compare budget vs premium restaurant segment in India.

select case 
           when Price_range IN (1,2) then 'Budget'
		   when Price_range in (3,4) then 'Premium'
		   end as 'Segment',
		   COUNT(*) as 'total_restaurants',
		   avg(Rating) as 'avg_rating',
		   avg(Average_Cost_for_two) as 'avg_cost',
		   avg(Votes) as 'avg_votes',
		   SUM(case when Has_online_delivery ='Yes' then 1 else 0 end) as 'no of Has_online_delivery',
		   SUM(case when Has_table_booking ='Yes' then 1 else 0 end) as 'no of Has_table_booking'
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country='India'
group by  case 
           when Price_range IN (1,2) then 'Budget'
		   when Price_range in (3,4) then 'Premium'
		   end 

select * from Restaurant_Data


-- 7. City-wise rating distribution in top 5 Indian cities.


with Top_cites as
(select top 5 City
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country='India'
group by City)

select t.city, COUNT(*) as total_cities,
       SUM(case when rating >= 4 then 1 else 0 end) as 'Excellent_rating',
	   sum(case when rating >= 3 then 1 else 0 end) as 'Good_rating',
	   sum(case when rating > 0 then 1 else 0 end ) as 'Poor_rating',
	   sum(case when rating < 0 then 1 else 0 end ) as 'No_rating'

from top_cites t
join Restaurant_Data r
on t.city=r.City
group by t.city
order by total_cities desc


 -- Creating View

 create view top_cites as (
 select   top 5 City
 from Restaurant_Data r
 join Country_Data c
 on r.CountryCode=c.Country_Code
 where Country='India'
 group by City)

 select t.City, COUNT(*) as 'Total_cites',
        SUM( case when Rating >= 4 then 1 else 0 end) as 'Execellent',
		SUM( case when Rating >=3 then 1 else 0 end) as 'good',
		sum(case when rating >0 then 1 else 0 end) as 'pr',
		SUM( case when rating <0 then 1 else 0 end) as  'no_rating'
 from top_cites t
 join Restaurant_Data r
 on t.City=r.City
 group by t.City
 order by Total_cites desc


-- 8. Compare average dining costs across different countries.

select Country, avg(Average_Cost_for_two) as 'Avg_cost',
                Currency
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
group by Country, Currency
order by Avg_cost desc 


-- 9. Analyz the digital service adoption across India cities.

select City, count(*) restaurant_count,
    sum(case 
            when Has_Online_delivery = 'Yes' or Has_Table_booking = 'Yes' then 1 
            else 0 
        end) digital_adoption_count,
    sum(case 
            when Has_Online_delivery = 'Yes' or Has_Table_booking = 'Yes' then 1 
            else 0 
        end) * 100 / count(*) as digital_adoption_percentage
from country_data cd 
join restaurant_data rd 
on cd.Country_Code = rd.CountryCode 
where Country = 'India' 
group by city 
order by 2 desc;


-- practice

select top 10 City, COUNT(*) as 'Total_restarurants',
       SUM( case when Has_Online_delivery = 'Yes' OR Has_Table_booking = 'yes' then 1 else 0 end) as 'Digital_Adoption',
	   sum(case when Has_Online_delivery = 'yes' Or Has_Table_booking = 'yes' then 1 else 0 end ) * 100 / COUNT(*)
	   as 'Percentage of digital adoption'


from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country='India'
group by City
order by [Percentage of digital adoption] desc



-- 10. Top rated restaurants in India with high vote count.

select top 20 RestaurantID,
    RestaurantName,
    City,
    Cuisines, 
    Rating,
    Votes,
    Average_Cost_for_two,
    Has_Online_delivery,
    Has_Table_booking
from country_data cd 
join restaurant_data rd 
on cd.Country_Code = rd.CountryCode 
where Country = 'India' 
    and Rating >= 4
    and Votes >= 100 
order by 5 desc, 6 desc;



-- practice 

select top 20 RestaurantID,
    RestaurantName,
    City,
    Cuisines, 
    Rating,
    Votes,
    Average_Cost_for_two,
    Has_Online_delivery,
    Has_Table_booking
from Restaurant_Data r
join Country_Data c
on r.CountryCode=c.Country_Code
where Country = 'India' and Rating >=4 and Votes >= 100
order by Rating desc, Votes desc


-- 11. India vs other countries - service features comparison.

select case 
        when Country = 'India' then 'India'
        else 'Other Countries'
       end as region,
       count(*) restaurant_count,
       avg(Rating) avg_rating,
       avg(Votes) avg_votes,
       sum(case 
            when Has_Online_delivery = 'Yes' or Has_Table_booking = 'Yes' then 1 
            else 0 
        end) * 100 / count(*) as digital_adoption_percentage
from restaurant_data rd 
join country_data cd 
on cd.Country_Code = rd.CountryCode 
group by 
    case 
        when Country = 'India' then 'India'
        else 'Other Countries'
    end ;


/* HOMEWORK

1. Market Penetration Analysis - India vs International 
    - Compare Zomato's market presence and performance across key countries.
    - 'India', 'United States', 'UAE', 'Singapore', 'Australia'
2. Cuisine Diversity Analysis by Indian Cities
    - Measure culinary diversity across Indian cities. 
    
*/
